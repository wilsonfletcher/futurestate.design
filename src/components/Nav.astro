---
import Button from './Button.vue';

interface Props {
  nav: {
    id: string,
    name: string,
    items: Item[]
  }
}

interface Item {
  name: string,
  url: string
}

const { nav } = {
  ...Astro.props
} as Props
---

<nav aria-labelledby={nav.id} id="main-navigation">
  <h2 id={nav.id} class="hidden">{nav.name}</h2>
  <ul class="flex lg:gap-5">
    {nav.items.map((item) =>
      <li>
        <Button as="a" href={item.url} class="text-current">
          {item.name}
        </Button>
      </li>
    )}
  </ul>
</nav>

<script>
const mainNav = document.querySelector('#main-navigation')
const mainMenu = mainNav.querySelector('ul')

const setActiveMenuItem = () => {
  const menuItems = [...mainMenu.querySelectorAll('a:not([rel*="external"])')]
  menuItems.forEach(menuItem => {
    if (menuItem.pathname === window.location.pathname) {
      menuItem.classList.add('is-active')
      menuItem.setAttribute('aria-current', 'page')
    }
  })
}
setActiveMenuItem()
</script>
